# start-postgres.sh

[readmeへ](../README.md) | [ドキュメント作成ガイドラインへ](../doc.md) | [syllabus.shへ](./syllabus.md)

PostgreSQLサービスの起動と初期化を行うスクリプト。

## 目次
1. [機能](#機能)
2. [使用方法](#使用方法)
3. [処理の流れ](#処理の流れ)
4. [依存関係](#依存関係)
5. [注意事項](#注意事項)
6. [更新履歴](#更新履歴)

## 機能

1. 初期化ファイルの生成
   - 環境変数ファイル（`.env`）から設定を読み込み
   - 初期化SQLファイル（`01-init.sql`、`02-init-dev.sql`）を生成
   - マイグレーションファイルの自動挿入

2. PostgreSQLサービスの起動
   - Docker Composeを使用してサービスを起動
   - コンテナの起動を待機

3. データベースの状態確認
   - 各テーブルのレコード数を表示

## 使用方法

```bash
./syllabus.sh -p start
```

## 処理の流れ

1. 初期化ファイルの生成
   - 環境変数ファイルの存在確認
   - テンプレートファイルのコピー
   - 環境変数の置換
   - マイグレーションファイルの自動挿入

2. PostgreSQLの起動
   - `docker-compose up -d`の実行
   - 10秒間の待機

3. テーブル数の確認
   - 各テーブルのレコード数を表示

## 依存関係

- Docker
- Docker Compose
- PostgreSQLコンテナ
- 環境変数ファイル（`.env`）
- 初期化SQLテンプレート（`init/init.sql.template`、`init/init-dev.sql.template`）
- マイグレーションファイル（`init/migrations/*.sql`）

## 注意事項

- 実行前に`.env`ファイルが存在することを確認
- 必要な環境変数が設定されていることを確認
- マイグレーションファイルは`init/migrations/`ディレクトリに配置
- コンテナ名は`postgres-db`を使用

## 更新履歴

| 日付 | バージョン | 更新者 | 内容 |
|------|------------|--------|------|
| 2024-03-20 | 1.0.0 | 開発者名 | 初版作成 |

[🔝 ページトップへ](#start-postgressh) 