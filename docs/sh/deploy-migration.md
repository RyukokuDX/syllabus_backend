<!--
更新時の注意事項:
- 準拠とは、類推せずに内容に従うこと
- 更新は docs/doc.md に準拠すること
-->

# deploy-migration.sh

[readmeへ](../README.md) | [ドキュメント作成ガイドラインへ](../doc.md) | [syllabus.shへ](./syllabus.md)

マイグレーションを本番環境に適用するスクリプト。

## 目次
1. [機能](#機能)
2. [使用方法](#使用方法)
3. [処理の流れ](#処理の流れ)
4. [依存関係](#依存関係)
5. [注意事項](#注意事項)
6. [更新履歴](#更新履歴)

## 機能

1. マイグレーションファイルのコピー
   - `migrations_dev`から`migrations`ディレクトリへのコピー

2. マイグレーションの適用
   - 本番データベースにマイグレーションを適用
   - 適用結果の確認

3. テーブル数の確認
   - 各テーブルのレコード数を表示

## 使用方法

```bash
./syllabus.sh -p deploy
```

## 処理の流れ

1. マイグレーションファイルのコピー
   - `migrations_dev`ディレクトリのファイルを`migrations`ディレクトリにコピー

2. マイグレーションの適用
   - 本番データベースに接続
   - 最新のSQLファイルを実行
   - 実行結果を確認

3. テーブル数の確認
   - 各テーブルのレコード数を表示

## 依存関係

- PostgreSQLサービスが起動していること
- `migrations_dev`ディレクトリにマイグレーションファイルが存在すること
- 環境変数ファイル（`.env`）が正しく設定されていること

## 注意事項

- 実行前にPostgreSQLサービスが起動していることを確認
- マイグレーションファイルは`migrations_dev`ディレクトリに配置
- コンテナ名は`postgres-db`を使用
- データベース名とユーザー名は環境変数から取得
- 本番環境への適用なので、慎重に実行する必要がある

## 更新履歴

| 日付 | バージョン | 更新者 | 内容 |
|------|------------|--------|------|
| 2024-03-20 | 1.0.0 | 開発者名 | 初版作成 |

[🔝 ページトップへ](#deploy-migrationsh) 