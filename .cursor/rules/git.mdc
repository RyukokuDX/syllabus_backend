---
description: git
globs: 
alwaysApply: false
---
## コミットメッセージ

### 基本形式
- 変更内容を明確に記述
- 例：「fix: ログインエラーを修正」「feat: ユーザー登録機能を追加」

### プレフィックス
- `feat:` - 新機能
- `fix:` - バグ修正
- `docs:` - ドキュメントの変更
- `style:` - コードの意味に影響を与えない変更
- `refactor:` - バグ修正や機能追加を含まないコードの変更
- `test:` - テストの追加・修正
- `chore:` - ビルドプロセスやツールの変更

### コミットメッセージの例
1. **通常のコミットメッセージ**
   ```
   docs: cursor.mdのコメントアウト内容を更新し、ファイル作成時の注意事項を追加。不要なPowerShellスクリプトとディレクトリ初期化スクリプトを削除。
   ```

2. **推奨されるコミットメッセージ形式**
   ```
   docs: cursor.mdの更新 (v1.0.1)

   Changes by file:
   docs/cursor.md (v1.0.1)
   - docs: コメントアウト内容を更新
   - docs: ファイル作成時の注意事項を追加

   scripts/init.ps1 (v1.0.1)
   - chore: PowerShellスクリプトを削除

   scripts/init.sh (v1.0.1)
   - chore: ディレクトリ初期化スクリプトを削除

   Details:
   - ファイル作成時の注意事項を明確化
   - 不要なスクリプトを整理
   ```

## ブランチ管理

### ブランチ命名規則
- 機能開発: `feature/機能名`
- バグ修正: `bugfix/修正内容`
- パッチ: `patch/修正内容`

### ブランチ運用
- 機能開発は feature/機能名 ブランチで実施
- パッチレベルの更新は個別ブランチで管理
- ブランチは目的を達成したら削除

## バージョン管理

### セマンティックバージョニング
- メジャー.マイナー.パッチ形式を採用
- 例：1.0.0, 1.1.0, 1.1.1

### タグ管理
- リリース時はタグを付与（例：v1.0.0）
- ファイルごとのバージョン管理もタグで実施
  - 例：docs/version_control.md@v1.0.0
  - コミットメッセージにファイルのバージョン情報を含める

### ブランチ運用
- developブランチには minor と major の更新のみをプッシュ
- パッチレベルの更新は個別ブランチで管理

## アップデートのコミット方法

### patch level（ブランチでの作業）
- 個別の修正や小さな変更をコミット
- コミットメッセージ例：「fix: ログインエラーを修正」

### minor/major update（developへのマージ時）
- patch levelのコミットをsquashして1つのコミットにまとめる
- マージコミットメッセージでバージョンアップを明示
- 例：「feat: ユーザー認証システムの改善 (v1.1.0)」
- 変更内容の詳細をマージコミットメッセージに記載

## マージ戦略

### patch levelの修正履歴の保持方法
1. **通常のマージを使用**
   - `git merge --no-ff` を使用してマージコミットを作成
   - 個別のpatchレベルのコミット履歴が保持される
   - 例：
     ```bash
     git checkout develop
     git merge --no-ff feature/patch-updates
     ```

2. **マージコミットメッセージの活用**
   - マージコミットメッセージに変更内容を詳細に記載
   - 個別のpatchレベルのコミットハッシュを参照
   - 例：
     ```
     Merge patch updates (v1.0.1)

     - ログインエラー修正 (abc1234)
     - パフォーマンス改善 (def5678)
     - ドキュメント更新 (ghi9012)
     ```

3. **タグの活用**
   - 重要なpatchレベルの修正にタグを付与
   - 例：`v1.0.1-patch1`, `v1.0.1-patch2`
   - タグメッセージに修正内容を記載

### コミットメッセージへのpatch levelリストの追加方法
1. **マージ時のコミットメッセージ作成**
   ```bash
   # コミットメッセージを一時ファイルに保存
   git log feature/patch-updates --oneline > /tmp/commit-messages.txt
   
   # マージを実行（エディタでコミットメッセージを編集）
   git merge --no-ff feature/patch-updates
   ```

2. **コミットメッセージの形式**
   ```
   Merge patch updates (v1.0.1)

   Changes by file:
   docs/version_control.md (v1.0.1)
   - fix: ログインエラーを修正 (abc1234)
   - docs: API仕様書を更新 (ghi9012)

   src/auth/login.py (v1.0.1)
   - fix: バリデーション処理を修正 (def5678)
   - perf: クエリを最適化 (jkl3456)

   Details:
   - ログイン時のバリデーション処理を修正
   - インデックスを追加してクエリを最適化
   - 新規エンドポイントの説明を追加
   ```

3. **自動化スクリプトの例**
   ```bash
   #!/bin/bash
   BRANCH=$1
   VERSION=$2
   
   # ファイルごとのコミットメッセージを取得
   FILES=$(git diff --name-only develop...$BRANCH)
   for file in $FILES; do
     echo "$file ($VERSION)"
     git log $BRANCH --oneline -- "$file"
     echo
   done > /tmp/commit-messages.txt
   
   # マージを実行
   git merge --no-ff $BRANCH -m "Merge patch updates ($VERSION)

   Changes by file:
   $(cat /tmp/commit-messages.txt)"
   ```

### 推奨される運用
- パッチレベルの修正は個別のブランチで管理
- 修正が完了したら`--no-ff`オプションでマージ
- マージコミットメッセージに変更内容を詳細に記載
- 必要に応じてタグを付与
- コミットメッセージには変更の詳細な説明を含める
- ファイルごとに変更内容をまとめて記載
- 複数のファイルを変更する場合は、ファイルごとの変更内容を明確に記載

